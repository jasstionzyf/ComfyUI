{"last_node_id":237,"last_link_id":431,"nodes":[{"id":75,"type":"UltimateSDUpscale","pos":[2542,-120],"size":{"0":315,"1":614},"flags":{},"order":15,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":422,"label":"image","slot_index":0},{"name":"model","type":"MODEL","link":424,"label":"model"},{"name":"positive","type":"CONDITIONING","link":361,"slot_index":2,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":364,"slot_index":3,"label":"negative"},{"name":"vae","type":"VAE","link":139,"label":"vae"},{"name":"upscale_model","type":"UPSCALE_MODEL","link":140,"slot_index":5,"label":"upscale_model"},{"name":"upscale_by","type":"FLOAT","link":141,"widget":{"name":"upscale_by"},"slot_index":6,"label":"upscale_by"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[228,232],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"UltimateSDUpscale"},"widgets_values":[3,931044956759291,"randomize",20,7,"euler_ancestral","karras",0.35000000000000003,"Linear",1024,1024,8,32,"None",1,64,8,16,"enable",false]},{"id":130,"type":"StableSRColorFix","pos":[2171,426],"size":{"0":315,"1":78},"flags":{},"order":18,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":232,"label":"image"},{"name":"color_map_image","type":"IMAGE","link":231,"label":"color_map_image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[234,235,326],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"StableSRColorFix"},"widgets_values":["Wavelet"]},{"id":131,"type":"GetImageSize","pos":[2169,331],"size":[317.7512287738891,50.28238999548023],"flags":{"collapsed":false},"order":16,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":228,"label":"image"}],"outputs":[{"name":"width","type":"INT","links":[229],"shape":3,"slot_index":0,"label":"width"},{"name":"height","type":"INT","links":[230],"shape":3,"slot_index":1,"label":"height"}],"properties":{"Node name for S&R":"GetImageSize"}},{"id":78,"type":"UpscaleModelLoader","pos":[2170,222],"size":{"0":315,"1":58},"flags":{},"order":0,"mode":0,"outputs":[{"name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[140],"shape":3,"label":"UPSCALE_MODEL"}],"properties":{"Node name for S&R":"UpscaleModelLoader"},"widgets_values":[null]},{"id":214,"type":"ControlNetApplyAdvanced","pos":[2170,-9],"size":{"0":315,"1":166},"flags":{},"order":14,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":360,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":363,"label":"negative"},{"name":"control_net","type":"CONTROL_NET","link":359,"label":"control_net"},{"name":"image","type":"IMAGE","link":421,"label":"image"}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[361],"shape":3,"label":"positive","slot_index":0},{"name":"negative","type":"CONDITIONING","links":[364],"shape":3,"label":"negative","slot_index":1}],"properties":{"Node name for S&R":"ControlNetApplyAdvanced"},"widgets_values":[0.9,0,0.9]},{"id":80,"type":"ControlNetLoader","pos":[2167,-129],"size":{"0":320.78424072265625,"1":67.64601135253906},"flags":{},"order":1,"mode":0,"outputs":[{"name":"CONTROL_NET","type":"CONTROL_NET","links":[359],"shape":3,"slot_index":0,"label":"CONTROL_NET"}],"properties":{"Node name for S&R":"ControlNetLoader"},"widgets_values":["controlnet-canny-sdxl-1.0/diffusion_pytorch_model.safetensors"]},{"id":128,"type":"ImageScaleBy","pos":[1430,433],"size":{"0":315,"1":82},"flags":{},"order":9,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":419,"label":"image"},{"name":"scale_by","type":"FLOAT","link":225,"widget":{"name":"scale_by"},"label":"scale_by"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[226],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"ImageScaleBy"},"widgets_values":["lanczos",2]},{"id":86,"type":"CLIPTextEncode","pos":[1521,312],"size":{"0":217.8780975341797,"1":56.58431625366211},"flags":{},"order":13,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":153,"label":"clip"},{"name":"text","type":"STRING","link":431,"widget":{"name":"text"},"label":"text"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[360],"shape":3,"slot_index":0,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["high detail, best quality"],"color":"#222"},{"id":89,"type":"Reroute","pos":[1437,293],"size":[75,26],"flags":{},"order":6,"mode":0,"inputs":[{"name":"","type":"*","link":426,"label":""}],"outputs":[{"name":"CLIP","type":"CLIP","links":[153,202],"label":"CLIP"}],"properties":{"showOutputText":true,"horizontal":false}},{"id":198,"type":"Reroute","pos":[1439,338],"size":[75,26],"flags":{},"order":7,"mode":4,"inputs":[{"name":"","type":"*","link":418,"label":""}],"outputs":[{"name":"","type":"IMAGE","links":[331,419,421,422,423],"label":"","slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":127,"type":"SaveImage","pos":[2286,-655],"size":{"0":562.8740234375,"1":437.2073974609375},"flags":{},"order":22,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":325,"label":"images"}],"title":"超分后缩小","properties":{},"widgets_values":["ComfyUI"]},{"id":92,"type":"Image Comparer (rgthree)","pos":{"0":1577,"1":-657,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"size":{"0":653.4579467773438,"1":432.60040283203125},"flags":{},"order":20,"mode":0,"inputs":[{"name":"image_a","type":"IMAGE","link":331,"dir":3,"label":"image_a","slot_index":0},{"name":"image_b","type":"IMAGE","link":235,"dir":3,"label":"image_b"}],"outputs":[],"title":"对比","properties":{"comparer_mode":"Slide"},"widgets_values":[["/view?filename=rgthree.compare._temp_qyimz_00005_.png&type=temp&subfolder=&rand=0.32753274975213853","/view?filename=rgthree.compare._temp_qyimz_00006_.png&type=temp&subfolder=&rand=0.19075971420111637"]]},{"id":117,"type":"SaveImage","pos":[918,-659],"size":{"0":576.656005859375,"1":416.6006164550781},"flags":{},"order":19,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":234,"label":"images"}],"properties":{},"widgets_values":["ComfyUI"]},{"id":197,"type":"ImageScaleBy","pos":[2299,-786],"size":{"0":315,"1":82},"flags":{},"order":21,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":326,"label":"image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[325],"shape":3,"label":"IMAGE","slot_index":0}],"properties":{"Node name for S&R":"ImageScaleBy"},"widgets_values":["area",0.5]},{"id":90,"type":"Float","pos":[815,-95],"size":[555.4862060546875,72.14442443847656],"flags":{},"order":3,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[141,225],"shape":3,"label":"FLOAT","slot_index":0}],"title":"Tile 放大比率（建议4）","properties":{"Node name for S&R":"Float"},"widgets_values":[2],"color":"#432","bgcolor":"#653"},{"id":112,"type":"Gemini_API_S_Zho","pos":[1772,-13],"size":{"0":355.0140380859375,"1":207.28726196289062},"flags":{},"order":9,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":423,"slot_index":0,"label":"image"}],"outputs":[{"name":"text","type":"STRING","links":[211],"shape":3,"slot_index":0,"label":"text"}],"properties":{"Node name for S&R":"Gemini_API_S_Zho"},"widgets_values":["text = ' ' # @param {type:\"string\"}\n\nprompt = \"You are creating a prompt for Stable Diffusion to generate an image. First step: describe the people and background in this image, then put description into text. Second step: generate a text prompt for %s based on first step.  Only respond with the prompt itself, but embellish it as needed but keep it under 50 tokens.\" % text","gemini-pro-vision",false],"color":"#222"},{"id":116,"type":"CLIPTextEncode","pos":[1762,-150],"size":{"0":369.3165283203125,"1":76.00001525878906},"flags":{},"order":8,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":202,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[363],"shape":3,"label":"CONDITIONING","slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["crayon, sketch, graphite, impressionist, noisy, blurry, soft, deformed, uglg, painting, drawing, illustration, deformed, mutated"]},{"id":76,"type":"CheckpointLoaderSimple","pos":[1428,156],"size":{"0":315,"1":98},"flags":{},"order":3,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[424],"shape":3,"slot_index":0,"label":"MODEL"},{"name":"CLIP","type":"CLIP","links":[426],"shape":3,"slot_index":1,"label":"CLIP"},{"name":"VAE","type":"VAE","links":[139],"shape":3,"slot_index":2,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["animaPencilXL_v300.safetensors"]},{"id":129,"type":"ImageScale","pos":[1774,398],"size":{"0":358.8062744140625,"1":122},"flags":{},"order":17,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":226,"label":"image"},{"name":"width","type":"INT","link":229,"widget":{"name":"width"},"label":"width"},{"name":"height","type":"INT","link":230,"widget":{"name":"height"},"label":"height"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[231],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"ImageScale"},"widgets_values":["lanczos",512,512,"disabled"]},{"id":113,"type":"DisplayText_Zho","pos":[1767,240],"size":{"0":358.02166748046875,"1":114.77532196044922},"flags":{},"order":11,"mode":0,"inputs":[{"name":"text","type":"STRING","link":211,"widget":{"name":"text"},"label":"text","slot_index":0}],"outputs":[{"name":"text","type":"STRING","links":[429],"shape":3,"slot_index":0,"label":"text"}],"properties":{"Node name for S&R":"DisplayText_Zho"},"widgets_values":["","A young man with dark hair and a beard is wearing a black t-shirt and jeans. He is standing with his hands in his pockets. He has a confident expression on his face. The background is a dark grey."],"color":"#222"},{"id":236,"type":"Simple String Combine (WLSH)","pos":[1429,-148],"size":[316.19584960937505,102],"flags":{},"order":12,"mode":0,"inputs":[{"name":"input_string","type":"STRING","link":430,"widget":{"name":"input_string"},"label":"input_string"},{"name":"addition","type":"STRING","link":429,"widget":{"name":"addition"},"label":"addition"}],"outputs":[{"name":"combined","type":"STRING","links":[431],"shape":3,"slot_index":0,"label":"combined"}],"properties":{"Node name for S&R":"Simple String Combine (WLSH)"},"widgets_values":["","after","comma",""]},{"id":237,"type":"Text box","pos":[1436,0],"size":[306.1558898925782,103.4623901367188],"flags":{},"order":5,"mode":0,"outputs":[{"name":"STRING","type":"STRING","links":[430],"shape":3,"label":"STRING","slot_index":0}],"properties":{"Node name for S&R":"Text box"},"widgets_values":["masterpiece, high quality,"]},{"id":12,"type":"LoadImage","pos":[-1056,-225],"size":{"0":573.42333984375,"1":445.68377685546875},"flags":{},"order":5,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[418],"shape":3,"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["10004-4265251904-RAW photo, best quality, masterpiece, ultra high res, (photorealistic_1.4),highly detailed, intricate detail, great textures, ul (2).png","image"],"color":"#432","bgcolor":"#653"}],"links":[[139,76,2,75,4,"VAE"],[140,78,0,75,5,"UPSCALE_MODEL"],[141,90,0,75,6,"FLOAT"],[153,89,0,86,0,"CLIP"],[202,89,0,116,0,"CLIP"],[211,112,0,113,0,"STRING"],[225,90,0,128,1,"FLOAT"],[226,128,0,129,0,"IMAGE"],[228,75,0,131,0,"IMAGE"],[229,131,0,129,1,"INT"],[230,131,1,129,2,"INT"],[231,129,0,130,1,"IMAGE"],[232,75,0,130,0,"IMAGE"],[234,130,0,117,0,"IMAGE"],[235,130,0,92,1,"IMAGE"],[325,197,0,127,0,"IMAGE"],[326,130,0,197,0,"IMAGE"],[331,198,0,92,0,"IMAGE"],[359,80,0,214,2,"CONTROL_NET"],[360,86,0,214,0,"CONDITIONING"],[361,214,0,75,2,"CONDITIONING"],[363,116,0,214,1,"CONDITIONING"],[364,214,1,75,3,"CONDITIONING"],[418,12,0,198,0,"*"],[419,198,0,128,0,"IMAGE"],[421,198,0,214,3,"IMAGE"],[422,198,0,75,0,"IMAGE"],[423,198,0,112,0,"IMAGE"],[424,76,0,75,1,"MODEL"],[426,76,1,89,0,"*"],[429,113,0,236,1,"STRING"],[430,237,0,236,0,"STRING"],[431,236,0,86,1,"STRING"]],"groups":[],"config":{},"extra":{"groupNodes":{"control":{"nodes":[{"id":-1,"type":"Fast Groups Bypasser (rgthree)","pos":{"0":-430,"1":-576,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"size":{"0":355.7608337402344,"1":154},"flags":{},"order":13,"mode":0,"inputs":[],"outputs":[{"name":"OPT_CONNECTION","type":"*","links":null,"label":"OPT_CONNECTION"}],"properties":{"matchColors":"","matchTitle":"","showNav":true,"sort":"position","customSortAlphabet":"","toggleRestriction":"default"},"index":0},{"type":"CR Image Input Switch","pos":[-403,-732],"size":{"0":315,"1":78},"flags":{},"order":29,"mode":0,"inputs":[{"name":"image1","type":"IMAGE","link":null,"label":"image1"},{"name":"image2","type":"IMAGE","link":null,"label":"image2"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[],"shape":3,"label":"IMAGE","slot_index":0},{"name":"show_help","type":"STRING","links":null,"shape":3,"label":"show_help"}],"properties":{"Node name for S&R":"CR Image Input Switch"},"widgets_values":[1],"index":1}],"links":[[null,5,1,0,150,"IMAGE"],[null,0,1,1,12,"IMAGE"]],"external":[[1,0,"IMAGE"]]},"首次采样缩放控制":{"nodes":[{"type":"Cfg Literal","pos":[-145,-826],"size":{"0":315,"1":58},"flags":{},"order":14,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[],"shape":3,"label":"FLOAT"}],"title":"首次采样放大率","properties":{"Node name for S&R":"Cfg Literal"},"widgets_values":[1],"index":0},{"type":"Cfg Literal","pos":[-145,-713],"size":{"0":315,"1":58},"flags":{},"order":13,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[],"shape":3,"label":"FLOAT"}],"title":"首次超采后缩小率","properties":{"Node name for S&R":"Cfg Literal"},"widgets_values":[0.5],"index":1}],"links":[],"external":[[{"type":"Cfg Literal","pos":[-145,-713],"size":{"0":315,"1":58},"flags":{},"order":13,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[],"shape":3,"label":"FLOAT"}],"title":"首次超采后缩小率","properties":{"Node name for S&R":"Cfg Literal"},"widgets_values":[0.5],"index":1},0,"FLOAT"],[{"type":"Cfg Literal","pos":[-145,-826],"size":{"0":315,"1":58},"flags":{},"order":14,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[],"shape":3,"label":"FLOAT"}],"title":"首次采样放大率","properties":{"Node name for S&R":"Cfg Literal"},"widgets_values":[1],"index":0},0,"FLOAT"]],"config":{"0":{"input":{"float":{"name":"首次采样放大率（这里不是真是倍数，是放大模型倍数）"}}},"1":{"input":{"float":{"name":"首次采样后缩小率"}}}}}},"workspace_info":{"id":"3ftxscIBBKJ5h-G2zZStq"},"ds":{"scale":0.6830134553650709,"offset":{"0":1232.569854457588,"1":802.6594118574246}}},"version":0.4}